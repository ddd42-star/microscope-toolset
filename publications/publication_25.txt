Systems biology
Mining single-cell time-series datasets with
Time Course Inspector
Maciej Dobrzy/C19nski*, Marc-Antoine Jacques and Olivier Pertz
Institute of Cell Biology, University of Bern, Bern 3012, Switzerland
*To whom correspondence should be addressed.
Associate Editor: Jonathan Wren
Received on July 3, 2019; revised on October 19, 2019; editorial decision on November 8, 2019; accepted on November 12, 2019
Abstract
Summary: Thanks to recent advances in live cell imaging of biosensors, microscopy experiments can generate thou-
sands of single-cell time-series. To identify sub-populations with distinct temporal behaviours that correspond to dif-
ferent cell fates, we developed Time Course Inspector (TCI)—a unique tool written in R/Shiny to combine time-series
analysis with clustering. With TCI it is convenient to inspect time-series, plot different data views and remove out-
liers. TCI facilitates interactive exploration of various hierarchical clustering and cluster validation methods. We
showcase TCI by analysing a single-cell signalling time-series dataset acquired using a ﬂuorescent biosensor.
Availability and implementation:https://github.com/pertzlab/shiny-timecourse-inspector.
Contact: maciej.dobrzynski@izb.unibe.ch
Supplementary information:Supplementary data are available at Bioinformatics online.
1 Introduction
Modern time-lapse microscopy can yield thousands of time-resolved
measurements of protein activities in individual cells. A novel
emerging concept is that single-cell measurements are heterogeneous
(Supplementary Fig. S1A) and thus more complex than population
averages obtained with classic biochemical methods ( Lahav and
Purvis, 2013; Lee and Covert, 2010 ). For example, growth factor
stimulation of an isogenic population of PC-12 cells, a paradigm for
the study of neuronal differentiation, can lead to transient or sus-
tained MAPK ERK activity profiles across cell population ( Ryu
et al., 2015). These different dynamics relate to distinct cell fates
(Supplementary Fig. S1B and C). Thus, understanding complexity of
signalling in a cell population requires extraction of dynamic pat-
terns from the multitude of time-series via clustering. The workflow
typically involves scripting in Python or R, and subsequent iterations
to obtain best partitioning. To ease this process we created an inter-
active R/Shiny application for hierarchical clustering, cluster valid-
ation and easy plotting of various data views.
2 Features and implementation
Time Course Inspector (TCI) accepts comma-separated values files
with time-series in long or wide formats. Data views include popula-
tion averages, individual time-series or mean power spectral density.
The area under the curve or measurements at chosen time points
can be displayed as box-, violin- and/or dot-plots. Scatter plots visu-
alize correlations between two time points. Other modules offer
hierarchical clustering with various distance measures, e.g.
Euclidean, dynamic time warping and sparse hierarchical clustering
(Witten and Tibshirani, 2010 ). Validation module assesses cluster-
ing tendency and quality of clustering. At various stages of the ana-
lysis plots can be viewed in the interactive mode and saved in PDF/
PNG formats or as an R object for further editing. The results, e.g.
assignments of time-series to clusters, can be exported as comma-
separated values files. For more information about the modules and
input/export formats see Supplementary Material.
3 Test case
To showcase TCI’s ability to identify dynamic signalling states in
single-cell time-lapse data, we study ERK activity dynamics in PC-
12 cells (Blum et al., 2019). We used microfluidics to challenge cells
with 30 pulses of fibroblast growth factor 2 (FGF2) at 20 0 intervals,
and measured single-cell ERK activity using a fluorescence reson-
ance energy transfer-based biosensor (Fritz et al., 2013). Image seg-
mentation, cell tracking and the computation of single-cell
fluorescence resonance energy transfer ratios yielded hundreds of
single-cell ERK activity trajectories. The INPUT (FGF2 pulses)—
OUTPUT (single-cell ERK activity dynamics) relationship contains
considerable information about the underlying structure of the
MAPK network. Using TCI, we identified important population
dynamics.
At 2.5 ng/ml FGF2, peaks of ERK activity follow the stimulus,
while at 250 ng/ml FGF2, the response is in anti-phase with the
stimulus indicated with red segments in Figure 1A. ERK activity at
selected time points (Fig. 1B) shows that the anti-phasic response to
250 ng/ml FGF2 ensues after the first peak when ERK activity
remains high and only transiently decreases in response to
VC The Author(s) 2019. Published by Oxford University Press. All rights reserved. For permissions, please e-mail: journals.permissions@oup.com 1968
Bioinformatics, 36(6), 2020, 1968–1969
doi: 10.1093/bioinformatics/btz846
Advance Access Publication Date: 14 November 2019
Applications Note
Downloaded from https://academic.oup.com/bioinformatics/article/36/6/1968/5625623 by University of Bern user on 06 March 2025

subsequent pulses. We discuss the biological mechanism behind this
effect in Blum et al.(2019).
At 2.5 and 250 ng/ml FGF2, the majority of cells in the popula-
tion are synchronous and have the characteristic in- and anti-phasic
behaviours reflected by the population mean ( Fig. 1A ). An inter-
mediate dose of 25 ng/ml FGF2 evokes high variability in ERK activ-
ity at the single-cell level, leading to a flat population mean. To
dissect this population we perform clustering with TCI (Fig. 1C–E).
The screencast, including the removal of outliers, normalization and
plotting different data views, is available online at https://youtu.be/
pwRqUzf5HMs.
We cut the dendrogram from hierarchical clustering into four
branches (Fig. 1C). We then inspected the composition of clusters
(Fig. 1D) and calculated the contribution of each cluster to the ex-
perimental condition (Fig. 1E). Clusters 2 and 4 include trajectories
where ERK is activated transiently right after the stimulation. In
contrast, trajectories that transiently decrease after the pulse of
FGF2 comprise clusters 1 and 3 (Fig. 1D). In line with an earlier ob-
servation, the 2.5 ng/ml FGF2 stimulation consists of in-phase clus-
ters 2 and 4, while 250 ng/ml FGF2 consists of anti-phase clusters 1
and 3. The intermediate 25 ng/ml FGF2, for which the mean ERK
response was flat, consists of a mixture of in- and anti-phasic
responses (Fig. 1E).
4 Conclusion
Single-cell, time-lapse fluorescence microscopy can generate hun-
dreds of time-series from a single experiment. Successive rounds of
clustering with different parameters are required to identify dynamic
patterns in such complex datasets. TCI’s interactivity enables rapid
exploration and therefore greatly accelerates time-series analysis,
even for users without coding experience. The mining of single-cell
dynamic patterns can radically enhance our understanding of signal-
ling as demonstrated in the case study. Clustering of single-cell
responses of signalling pathway activation revealed a complex be-
haviour within the population. This allowed us to discriminate be-
tween mechanistic models of the FGF2/MAPK signalling pathway
(Blum et al., 2019). TCI can also aid the discovery of behavioural
patterns in longitudinal studies such as those conducted in social sci-
ences. Owing to a highly modular structure of the app it is easy to
incorporate other analytic approaches.
Funding
This work was funded by an Interdisciplinary Grant from the University of
Bern, and by the Swiss National Science Foundation grant 176008.
Conflict of Interest: none declared.
References
Blum,Y. et al. (2019) Temporal perturbation of ERK dynamics reveals net-
work architecture of FGF2-MAPK signaling.Mol. Syst. Biol., 15, e8947.
Fritz,R.D. et al. (2013) A versatile toolkit to produce sensitive FRET biosen-
sors to visualize signaling in time and space.Sci. Signal., 6, rs12.
Lahav,G. and Purvis,J.E. (2013) Encoding and decoding cellular information
through signaling dynamics.Cell, 152, 945–956.
Lee,T.K. and Covert,M.W. (2010) High-throughput, single-cell NF- jB dy-
namics. Curr. Opin. Genet. Dev., 20, 677–683.
Ryu,H. et al. (2015) Frequency modulation of ERK activation dynamics
rewires cell fate.Mol. Syst. Biol., 11, 838.
Witten,D.M. and Tibshirani,R. (2010) A framework for feature selection in
clustering. J. Am. Stat. Assoc., 105, 713–726.
Time (min)
50 70 90 110
A
50 75 100 125 50 75 100 125
Time (min)
50 75 100 125
25 2502.5B
ERK activity
FGF2 (ng/ml):
1.1
1.2
1.3
1.4
1.5
Baseline 1   peakst 2    peaknd
Selected timepoints
C
1.0 1.21.1
Fold change  
ERK activity
50 75 100 125
4
50 75 100 125
2
1.0
1.1
1.2
Time (min)
D
Fold change ERK activity
Cluster: 1
1.0
1.1
1.2
3
0%
50%
100%Percentage of time-series
Cluster:
4
3
2
1
E
2.5 25 250
FGF2 (ng/ml)
FGF2 (ng/ml): 2.5 25 250
Baseline
1st 2    peaknd
ERK activity
1.1
1.2
1.3
1.4
1.5
Fig. 1.(A) ERK activity in single cells stimulated with 30 pulses of FGF2 (red segments). Solid red lines—the population mean. Outliers removed manually; see Supplementary
Figure S4.( B) Single-cell ERK activity before FGF2 application, and at the ﬁrst and second peak response. ( C) Clustering of normalized and clustered ERK activity using
Manhattan distance and complete linkage. Each row is a single time-series; black points— missing data. Dendrogram manually cut at four clusters to highlight main branches.
(D) Time-series in each of the four clusters. (E) Contribution of clusters to experimental treatments. At 25 ng/ml FGF2 is a mix of in- and anti-phasic responses, even though
the mean of this population in (A) is ﬂat. All plots generated with TCI
Mining single-cell time-series datasets with Time Course Inspector 1969
Downloaded from https://academic.oup.com/bioinformatics/article/36/6/1968/5625623 by University of Bern user on 06 March 2025
